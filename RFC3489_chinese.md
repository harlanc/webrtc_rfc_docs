#RFC 3489


# 摘要

简单UDP穿透NATs协议是一个轻量级的协议，应用使用此协议可以发现其是否位于NAT网络中，判断NAT类型、以及甄别公网和它们之间是否存在防火墙。同样也能够确定NAT分配给这些应用的公网IP地址。STUN适用于许多现存的NATs，能够让许多应用穿透现存的NAT网络。

# 适用声明

此协议并不能解决与NAT相关的所有问题。它不能够让TCP连接穿透NAT，允许UDP包穿透NAT，但也只限于现存NAT类型的一部分。比如，STUN是不能够让UDP包穿透对称性NAT的。

STUN不能获取同一NAT后面的主机地址。


# 介绍

网络地址转换（NATs）带来许多便利的同时，也有许多缺点。这些缺点带来的大多数麻烦是它们破坏了许多现存的IP应用，并且很难部署新的应用。于是提出了一些指导方针，描述如何才能建造"NAT友好的"协议，但是许多协议却因为这些指导方针不能被创建了。这些协议基本包括了所有的点对点协议，像多媒体通信，文件共享和游戏。

为了克服这个问题，NATs中嵌入了应用层网关（ALGs）。为了穿透NAT，应用层网关会为一个特定的协议执行应用层函数。这包含重写应用层消息来包含转换地址，而不是插入新的消息。ALGs有一系列的局限性，包括可扩展性，可靠性以及部署新应用的速度。为了解决这些问题，设计了中间件通信协议（MIDCOM）。为了获取NAT绑定以及打开或关闭网络穿洞，MIDCOM允许一个应用实体（比如一个终端或者一些类型的网络服务器（比如一个SIP代理））来控制NAT（或者防火墙）。用这种方式，NATs和应用会再次被隔离开，就不需要在NATs中嵌入ALGs了，同时也解决了现有架构的局限性。

不幸的是，MIDCOM出了要更新应用组件之外，还需要更新现存NAT和防火墙。这些NAT的完整更新需要很长一段时间，甚至要数年的时间。一部分原始是因为部署和使用应用的人与部署NAT和防火墙的人不是同一群人。许多情况下更新这些设备的意愿不会很高。比如，一个机场因特网休息室通过NAT访问互联网。连接到NATed网络的用户希望使用点对点服务，但是NAT却不支持。既然休息室的管理人员同服务提供者不是同一群人，他们没有动机更新NAT设备来支持点对点服务，不论是使用ALG还是MIDCOM。

另外一个问题是MIDCOM协议需要控制中间件的agent知道这些中间件的身份，并且这些agent要有访问控制权。在许多配置中，这是不可能的。比如，许多电缆接入提供商在其整个接入网络前使用NAT。这个NAT可能是由终端用户购买和操作的住宅NAT的补充。终端用户将可能不会拥有位于有线访问网络中NAT的控制权，甚至不可能知道它的存在。

许多现存的专有协议，比如为在线游戏（像RFC3027中描述的游戏）和VoIP，已经开发了一些技巧，允许在不改变NAT的情况下穿透NAT进行操作。这篇文档试图采用其中的一些想法，将其编写成可互操作的协议，来满足很多应用的需求。

